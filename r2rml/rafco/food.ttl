@base <http://rafco.jgsogo.es/linkeddata/def/rafco#>.

@prefix rr: <http://www.w3.org/ns/r2rml#>.
@prefix rafco: <http://rafco.jgsogo.es/linkeddata/def/rafco#>.
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix time: <http://www.w3.org/TR/owl-time#>.
@prefix xsd: <http://www.w3.org/2001/XMLSchema#>.


#########
# Food
#########
rafco:food
    rr:logicalTable [ rr:tableName "food_food" ];
    
    rr:subjectMap [
      rr:template 'http://rafco.jgsogo.es/linkeddata/recurso/food/{"NDB_no"}' ;
      rr:class rafco:Food ;
    ] ;
    rr:predicateObjectMap [
      rr:predicate rdfs:label;
      rr:objectMap [rr:column "Long_Desc";];
    ];
    rr:predicateObjectMap [
      rr:predicate rafco:longDesc;
      rr:objectMap [ rr:column "Long_Desc" ] ;
    ] ;

    rr:predicateObjectMap [
      rr:predicate rafco:shrtDesc;
      rr:objectMap [ rr:column "Shrt_Desc" ] ;
    ] ;
                      
    rr:predicateObjectMap [
      rr:predicate rafco:sciName;
      rr:objectMap [ rr:column "SciName" ] ;
    ].
    
#########
# Food nutrients - Many to many
#########
rafco:food-nutrient-with-amount
    rr:logicalTable [ rr:tableName "food_foodnutrients" ];
    
    rr:subjectMap [
        rr:template 'http://rafco.jgsogo.es/linkeddata/recurso/food/{"NDB_No_id"}' ;
    ] ;
    
    rr:predicateObjectMap [
      rr:predicate rafco:nutrientWithAmount ;
      rr:objectMap [ 
        rr:template 'http://rafco.jgsogo.es/linkeddata/recurso/nutrientwithamount/{"id"}' ;
      ] ;
    ] .

rafco:nutrient-with-amount
    rr:logicalTable [ rr:tableName "food_foodnutrients" ];
    
    rr:subjectMap [
        rr:template 'http://rafco.jgsogo.es/linkeddata/recurso/nutrientwithamount/{"id"}' ;
        rr:class rafco:NutrientWithAmount ;
    ] ;
    
    rr:predicateObjectMap [
      rr:predicate rafco:nutrient ;
      rr:objectMap [ 
        rr:template 'http://rafco.jgsogo.es/linkeddata/recurso/nutrient/{"Nutr_No_id"}' ;
      ] ;
    ] ;    
    
    rr:predicateObjectMap [
      rr:predicate rafco:amount ;
      rr:objectMap [ rr:column "Nutr_Val" ] ;
    ] .

#########
# Langual - Many to many
#########
rafco:langual
    rr:logicalTable [ rr:tableName "food_langual" ];

    rr:subjectMap [
        rr:template 'http://rafco.jgsogo.es/linkeddata/recurso/food/{"NDB_No_id"}' ;
    ] ;

    rr:predicateObjectMap [
      rr:predicate rafco:langual ;
      rr:objectMap [ 
        rr:template 'http://rafco.jgsogo.es/linkeddata/recurso/langual/{"Factor_Code_id"}' ;
      ] ;
    ] .


#########
# Langual description
#########
rafco:langual-desc
    rr:logicalTable [ rr:tableName "food_langualdesc" ];

    rr:subjectMap [
      rr:template 'http://rafco.jgsogo.es/linkeddata/recurso/langual/{"Factor_Code"}' ;
      rr:class rafco:Langual ; 
    ] ;
    rr:predicateObjectMap [
      rr:predicate rdfs:label;
      rr:objectMap [rr:column "Description";];
    ];
    rr:predicateObjectMap [
      rr:predicate rafco:description;
      rr:objectMap [ rr:column "Description" ] ;
    ] .
    
#########
# Weight - N ary relation
#########
rafco:food-weight
    rr:logicalTable [ rr:tableName "food_weight" ];
    
    rr:subjectMap [
      rr:template 'http://rafco.jgsogo.es/linkeddata/recurso/food/{"NDB_No_id"}' ;
    ] ;
    
    rr:predicateObjectMap [
      rr:predicate rafco:weightPerAmount;
      rr:objectMap [ rr:template 'http://rafco.jgsogo.es/linkeddata/recurso/weightperamount/{"id"}' ] ;
    ] .

rafco:weight-per-amount
    rr:logicalTable [ rr:tableName "food_weight" ];
    
    rr:subjectMap [
        rr:template 'http://rafco.jgsogo.es/linkeddata/recurso/weightperamount/{"id"}' ;
        rr:class rafco:WeightPerAmount ;
    ] ;
    
    rr:predicateObjectMap [
      rr:predicate rafco:foodAmount ;
      rr:objectMap [ rr:column "Amount" ] ;
    ] ;    

    rr:predicateObjectMap [
      rr:predicate rafco:gramWeight ;
      rr:objectMap [ rr:column "Gm_Wgt" ] ;
    ] ;    
    
    rr:predicateObjectMap [
      rr:predicate rafco:msreDesc ;
      rr:objectMap [ rr:template 'http://qudt.org/vocab/unit/{"Msre_Desc"}' ] ;
    ] .

rafco:weight-per-amount-msre
    rr:logicalTable [ rr:tableName "food_weight"; ];
    rr:subjectMap [ 
        rr:template 'http://qudt.org/vocab/unit/{"Msre_Desc"}';
        rr:class <http://qudt.org/schema/qudt#Unit>;
        rr:class <http://qudt.org/schema/qudt#NotUsedWithSIUnit>;
        ];
    rr:predicateObjectMap [
        rr:predicate rdfs:label;
        rr:objectMap [  rr:column "Msre_Desc";];
        ].

